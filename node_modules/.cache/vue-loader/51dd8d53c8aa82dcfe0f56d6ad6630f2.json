{"remainingRequest":"/Users/ericchen/Desktop/parttime/xinxin/surface/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ericchen/Desktop/parttime/xinxin/surface/src/components/team-home/home-tab-content.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/ericchen/Desktop/parttime/xinxin/surface/src/components/team-home/home-tab-content.vue","mtime":1575480545874},{"path":"/Users/ericchen/Desktop/parttime/xinxin/surface/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ericchen/Desktop/parttime/xinxin/surface/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ericchen/Desktop/parttime/xinxin/surface/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/ericchen/Desktop/parttime/xinxin/surface/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ericchen/Desktop/parttime/xinxin/surface/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport { Component, Vue, Watch } from \"vue-property-decorator\";\nimport { State } from \"vuex-class\";\nimport BreadNav from \"../common/bread-nav.vue\";\nimport HomeFormList from \"./home-form-list.vue\";\nimport HomeTable from \"./home-table.vue\";\nimport Pigination from \"../common/pagination.vue\";\nimport { ApiList } from '../../api/api';\n\n@Component({\n    components: {\n        BreadNav,\n        HomeFormList,\n        HomeTable,\n        Pigination\n    }\n})\nexport default class HomeTabContent extends Vue {\n    @State(\"HomeModule\") private HomeModule!: any;\n    @State(state => state.HomeModule.formParams.keyMap.optConfig.downloadFlag)\n    private downloadFlag!: any;\n    @State(state => state.HomeModule.formParams.keyMap.optConfig.downApiUrl)\n    private downApiUrl!: any;\n\n    private hasConfig: any = false;\n    private baseUrl: string = window.location.origin;\n    private downloadUrl: string = '';\n    private user: any = JSON.parse(<any>sessionStorage.getItem(\"userInfo\"));\n\n    created() {\n        this.downloadUrl = this.downApiUrl + '';\n        this.initConfig();\n        this.initDownloadEcel();\n    }\n\n    @Watch(\"HomeModule.formParams.config.formList\", {deep: true})\n    watchFormList(newVal: any, oldVal: any) {\n         this.downloadUrl = this.downApiUrl + '';\n        this.initDownloadEcel();\n    }\n\n    initConfig() {\n        this.hasConfig = this.HomeModule.formParams.hasOwnProperty(\"config\");\n    }\n\n    //下载导出\n    initDownloadEcel() {\n        \n        let obj: any = {};\n        this.$set(obj, \"userid\", this.user.id);\n        let url: string = this.downloadUrl;\n        this.HomeModule.formParams.config.formList.map((item: any, index: any) => {\n            if(item.type == 'select') {\n                this.$set(obj, item.name, item.value.value)\n            }\n            if(item.type == 'text') {\n                this.$set(obj, item.name, item.value)\n            }\n            if(item.type == 'date') {\n                this.$set(obj, item.name[0], this.formatDate(item.value[0]))\n                this.$set(obj, item.name[1], this.formatDate(item.value[1]))\n            }\n        })\n        \n        Object.keys(obj).map((item: any) => {\n            this.downloadUrl += item + \"=\" + obj[item] + \"&\";\n        });\n\n        this.downloadUrl = this.downloadUrl.slice(0, this.downloadUrl.length - 1);\n\n    }\n\n    createdDownload(href: any) {\n        let api: any = new ApiList();\n        api.getblobData(href).then((data: any) => {\n            console.log(data.data,new Blob([data.data]))\n            \n            let url: any = window.URL.createObjectURL(\n                new Blob([data.data], {\n                    type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n                })\n            );\n\n            window.open(url)\n\n            // var a = document.createElement('a');\n            // a.setAttribute('href', data.data);\n            // a.setAttribute('id', 'startTelMedicine');\n            // // 防止反复添加\n            // if(document.getElementById('startTelMedicine')) {\n            //     document.body.removeChild((<any>document.getElementById('startTelMedicine')));\n            // }\n            // document.body.appendChild(a);\n            // a.click();\n\n        })\n\n        // window.open(href)\n        // var a = document.createElement('a');\n        // a.setAttribute('href', href);\n        // a.setAttribute('id', 'startTelMedicine');\n        // // 防止反复添加\n        // if(document.getElementById('startTelMedicine')) {\n        //     document.body.removeChild((<any>document.getElementById('startTelMedicine')));\n        // }\n        // document.body.appendChild(a);\n        // a.click();\n    }\n\n    formatDate(date: any){\n        date = new Date(date);\n        var y=date.getFullYear();\n        var m=date.getMonth()+1;\n        var d=date.getDate();\n        m = m<10?(\"0\"+m):m;\n        d = d<10?(\"0\"+d):d;\n        return y+\"-\"+m+\"-\"+d;\n    }\n}\n",{"version":3,"sources":["home-tab-content.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"home-tab-content.vue","sourceRoot":"src/components/team-home","sourcesContent":["<template>\n    <div>\n        <BreadNav></BreadNav>\n        <HomeFormList v-if=\"hasConfig && HomeModule.formParams.config.formList.length > 0\"></HomeFormList>\n        <el-button \n            v-if=\"downloadFlag\" \n            :md=\"12\" \n            type=\"success\" \n            @click=\"createdDownload(downloadUrl)\"\n            class=\"down-btn\">\n            <!-- <a target=\"_top\" :href=\"downloadUrl\" style=\"color: #fff;text-decoration: none;\"> -->\n                导出\n                <i class=\"el-icon-download el-icon--right\"></i>\n            <!-- </a> -->\n            \n        </el-button>\n        <HomeTable></HomeTable>\n        <Pigination v-if=\"this.$route.path.indexOf('/home/data-countup') == -1\" ></Pigination>\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue, Watch } from \"vue-property-decorator\";\nimport { State } from \"vuex-class\";\nimport BreadNav from \"../common/bread-nav.vue\";\nimport HomeFormList from \"./home-form-list.vue\";\nimport HomeTable from \"./home-table.vue\";\nimport Pigination from \"../common/pagination.vue\";\nimport { ApiList } from '../../api/api';\n\n@Component({\n    components: {\n        BreadNav,\n        HomeFormList,\n        HomeTable,\n        Pigination\n    }\n})\nexport default class HomeTabContent extends Vue {\n    @State(\"HomeModule\") private HomeModule!: any;\n    @State(state => state.HomeModule.formParams.keyMap.optConfig.downloadFlag)\n    private downloadFlag!: any;\n    @State(state => state.HomeModule.formParams.keyMap.optConfig.downApiUrl)\n    private downApiUrl!: any;\n\n    private hasConfig: any = false;\n    private baseUrl: string = window.location.origin;\n    private downloadUrl: string = '';\n    private user: any = JSON.parse(<any>sessionStorage.getItem(\"userInfo\"));\n\n    created() {\n        this.downloadUrl = this.downApiUrl + '';\n        this.initConfig();\n        this.initDownloadEcel();\n    }\n\n    @Watch(\"HomeModule.formParams.config.formList\", {deep: true})\n    watchFormList(newVal: any, oldVal: any) {\n         this.downloadUrl = this.downApiUrl + '';\n        this.initDownloadEcel();\n    }\n\n    initConfig() {\n        this.hasConfig = this.HomeModule.formParams.hasOwnProperty(\"config\");\n    }\n\n    //下载导出\n    initDownloadEcel() {\n        \n        let obj: any = {};\n        this.$set(obj, \"userid\", this.user.id);\n        let url: string = this.downloadUrl;\n        this.HomeModule.formParams.config.formList.map((item: any, index: any) => {\n            if(item.type == 'select') {\n                this.$set(obj, item.name, item.value.value)\n            }\n            if(item.type == 'text') {\n                this.$set(obj, item.name, item.value)\n            }\n            if(item.type == 'date') {\n                this.$set(obj, item.name[0], this.formatDate(item.value[0]))\n                this.$set(obj, item.name[1], this.formatDate(item.value[1]))\n            }\n        })\n        \n        Object.keys(obj).map((item: any) => {\n            this.downloadUrl += item + \"=\" + obj[item] + \"&\";\n        });\n\n        this.downloadUrl = this.downloadUrl.slice(0, this.downloadUrl.length - 1);\n\n    }\n\n    createdDownload(href: any) {\n        let api: any = new ApiList();\n        api.getblobData(href).then((data: any) => {\n            console.log(data.data,new Blob([data.data]))\n            \n            let url: any = window.URL.createObjectURL(\n                new Blob([data.data], {\n                    type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\"\n                })\n            );\n\n            window.open(url)\n\n            // var a = document.createElement('a');\n            // a.setAttribute('href', data.data);\n            // a.setAttribute('id', 'startTelMedicine');\n            // // 防止反复添加\n            // if(document.getElementById('startTelMedicine')) {\n            //     document.body.removeChild((<any>document.getElementById('startTelMedicine')));\n            // }\n            // document.body.appendChild(a);\n            // a.click();\n\n        })\n\n        // window.open(href)\n        // var a = document.createElement('a');\n        // a.setAttribute('href', href);\n        // a.setAttribute('id', 'startTelMedicine');\n        // // 防止反复添加\n        // if(document.getElementById('startTelMedicine')) {\n        //     document.body.removeChild((<any>document.getElementById('startTelMedicine')));\n        // }\n        // document.body.appendChild(a);\n        // a.click();\n    }\n\n    formatDate(date: any){\n        date = new Date(date);\n        var y=date.getFullYear();\n        var m=date.getMonth()+1;\n        var d=date.getDate();\n        m = m<10?(\"0\"+m):m;\n        d = d<10?(\"0\"+d):d;\n        return y+\"-\"+m+\"-\"+d;\n    }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.down-btn {\n  margin-right: 34px;\n  margin-bottom: 20px;\n  float: right;\n}\n</style>\n"]}]}